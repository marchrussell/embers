---
description: Regras de validaÃ§Ã£o para agentes, comandos e estruturas do Sistema Onion
globs: .cursor/**
alwaysApply: false
---
# âœ… Regras de ValidaÃ§Ã£o

## ğŸ¯ Objetivo

Definir regras de validaÃ§Ã£o para garantir qualidade e consistÃªncia dos componentes do Sistema Onion.

## ğŸ“‹ ValidaÃ§Ã£o de Comandos

### Campos YAML ObrigatÃ³rios
```yaml
---
name: string          # âœ… ObrigatÃ³rio - kebab-case
description: string   # âœ… ObrigatÃ³rio - 1-2 linhas
model: string         # âœ… ObrigatÃ³rio - sonnet|opus|gpt-4
category: string      # âœ… ObrigatÃ³rio - categoria vÃ¡lida
tags: array           # âœ… ObrigatÃ³rio - 3-7 tags
version: string       # âœ… ObrigatÃ³rio - "3.0.0"
updated: string       # âœ… ObrigatÃ³rio - "YYYY-MM-DD"
---
```

### Categorias VÃ¡lidas de Comandos
```
engineer    # Fluxos de desenvolvimento
product     # GestÃ£o de produto
git         # OperaÃ§Ãµes Git
docs        # DocumentaÃ§Ã£o
meta        # Meta-comandos
validate    # ValidaÃ§Ãµes
quick       # AÃ§Ãµes rÃ¡pidas
general     # Uso geral (raiz)
```

### Checklist de Qualidade (Comandos)
- [ ] Nome em kebab-case Ãºnico
- [ ] DescriÃ§Ã£o clara e concisa
- [ ] Categoria vÃ¡lida
- [ ] Tags relevantes (3-7)
- [ ] VersÃ£o 3.0.0
- [ ] Data de atualizaÃ§Ã£o
- [ ] SeÃ§Ã£o "Objetivo" presente
- [ ] SeÃ§Ã£o "Processo/Fluxo" presente
- [ ] < 400 linhas total
- [ ] Sem duplicaÃ§Ã£o de nome

## ğŸ“‹ ValidaÃ§Ã£o de Agentes

### Campos YAML ObrigatÃ³rios
```yaml
---
name: string          # âœ… ObrigatÃ³rio - kebab-case
description: string   # âœ… ObrigatÃ³rio - especializaÃ§Ã£o
model: string         # âœ… ObrigatÃ³rio - sonnet|opus
category: string      # âœ… ObrigatÃ³rio - categoria vÃ¡lida
tags: array           # âœ… ObrigatÃ³rio - 3-7 tags
expertise: array      # âœ… ObrigatÃ³rio - 3-5 Ã¡reas
version: string       # âœ… ObrigatÃ³rio - "3.0.0"
updated: string       # âœ… ObrigatÃ³rio - "YYYY-MM-DD"
---
```

### Categorias VÃ¡lidas de Agentes
```
development   # Desenvolvimento (python, react, postgres)
product       # Produto (product-agent, task-specialist)
compliance    # Compliance (regulatory, security)
meta          # Meta (onion, metaspec, creators)
review        # Review (code-reviewer)
testing       # Testes (test-engineer, test-planner)
research      # Pesquisa (research-agent)
git           # Git (branch-*, integration)
```

### Checklist de Qualidade (Agentes)
- [ ] Nome em kebab-case Ãºnico
- [ ] DescriÃ§Ã£o da especializaÃ§Ã£o
- [ ] Categoria vÃ¡lida
- [ ] Expertise definida (3-5 Ã¡reas)
- [ ] VersÃ£o 3.0.0
- [ ] Data de atualizaÃ§Ã£o
- [ ] SeÃ§Ã£o "Identidade" presente
- [ ] SeÃ§Ã£o "Expertise" presente
- [ ] < 300 linhas total
- [ ] Sem duplicaÃ§Ã£o de nome

## ğŸ” ValidaÃ§Ãµes Automatizadas

### Verificar DuplicaÃ§Ã£o de Nome
```bash
# Comando para verificar duplicaÃ§Ã£o
find .cursor/commands -name "*.md" | xargs grep "^name:" | sort | uniq -d
find .cursor/agents -name "*.md" | xargs grep "^name:" | sort | uniq -d
```

### Verificar Campos ObrigatÃ³rios
```bash
# Campos que devem existir
required_fields=("name:" "description:" "model:" "category:" "version:")

for field in "${required_fields[@]}"; do
  grep -L "^$field" file.md && echo "FALTA: $field"
done
```

### Verificar Limite de Linhas
```bash
# Comandos > 400 linhas
find .cursor/commands -name "*.md" -exec wc -l {} \; | awk '$1 > 400'

# Agentes > 300 linhas
find .cursor/agents -name "*.md" -exec wc -l {} \; | awk '$1 > 300'
```

## âš ï¸ Regras de NegÃ³cio

### Geradores Devem Validar

**Antes de criar comando:**
1. Verificar se nome jÃ¡ existe em `.cursor/commands/`
2. Validar categoria estÃ¡ na lista permitida
3. Confirmar campos obrigatÃ³rios presentes
4. Verificar limite de 400 linhas

**Antes de criar agente:**
1. Verificar se nome jÃ¡ existe em `.cursor/agents/`
2. Validar categoria estÃ¡ na lista permitida
3. Confirmar expertise tem 3-5 itens
4. Verificar limite de 300 linhas

### Fallback para ValidaÃ§Ãµes
```
Se validaÃ§Ã£o falhar:
1. Informar usuÃ¡rio sobre o problema
2. Sugerir correÃ§Ã£o especÃ­fica
3. Perguntar se deseja corrigir automaticamente
4. Se nÃ£o, abortar com mensagem clara
```

## ğŸ“Š MÃ©tricas de Qualidade

### Score de Qualidade (0-100)
```
Comando:
+20 - YAML header completo
+20 - Categoria vÃ¡lida
+15 - Tags apropriadas
+15 - < 400 linhas
+15 - SeÃ§Ãµes obrigatÃ³rias
+15 - DocumentaÃ§Ã£o clara

Agente:
+20 - YAML header completo
+20 - Categoria vÃ¡lida
+15 - Expertise definida
+15 - < 300 linhas
+15 - SeÃ§Ãµes obrigatÃ³rias
+15 - EspecializaÃ§Ã£o clara
```

### Thresholds
- **80-100**: âœ… Aprovado
- **60-79**: âš ï¸ Precisa melhorias
- **< 60**: âŒ Rejeitado

## ğŸ”— IntegraÃ§Ãµes

### ValidaÃ§Ã£o de .env
```bash
# VariÃ¡veis obrigatÃ³rias para ClickUp
CLICKUP_API_TOKEN    # Token de API

# VariÃ¡veis opcionais
GITHUB_TOKEN         # Para PRs
GAMMA_TOKEN          # Para apresentaÃ§Ãµes
```

### Verificar ConfiguraÃ§Ã£o
```bash
# Script de verificaÃ§Ã£o
if [ -z "$CLICKUP_API_TOKEN" ]; then
  echo "âš ï¸ CLICKUP_API_TOKEN nÃ£o configurado"
  echo "Configure em .env ou execute /meta/setup-integration"
fi
```

---

**Ãšltima atualizaÃ§Ã£o:** 2025-11-24
**VersÃ£o:** 3.0.0
